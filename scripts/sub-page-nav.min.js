let currentScrollPos=0;let lastScrollPos=0;let updateRequested=false;let nav,main,navButtons;const pinned="nav-pinned";const unpinned="nav-unpinned";const lastSubpageKey="last-subpage";const subpageCount=2;let currentSubPage=0;$(()=>{nav=$("nav");main=$("main");$(window).bind("scroll",()=>{if($(window).scrollLeft()!==0)$(window).scrollLeft(0)});navButtons=[$("nav > div:first-child"),$("nav > div:last-child")];setTimeout(()=>{$(window).bind("scroll",()=>{currentScrollPos=window.pageYOffset;if(!updateRequested)requestAnimationFrame(update);updateRequested=true})},1e3);bindScrollEvents()});function bindScrollEvents(){navButtons[0].click(()=>animateChangeSubpage(0));navButtons[1].click(()=>animateChangeSubpage(1));$(document).keydown(event=>{if(event.which===37)animateChangeSubpage(0);else if(event.which===39)animateChangeSubpage(1)});delete Hammer.defaults.cssProps.userSelect;let hammer=new Hammer($("body").get(0),{touchAction:"auto",inputClass:Hammer.TouchInput});hammer.on("swipeleft",()=>animateChangeSubpage(1));hammer.on("swiperight",()=>animateChangeSubpage(0));hammer.get("swipe").set({threshold:100});hammer.off("pinch")}function animateChangeSubpage(index){index=parseInt(index);if(!subPageIndexValid(index))return;main.css("transform",index===0?"none":"translateX(-50%)");changeNavButtons(index);sessionStorage.setItem(lastSubpageKey,index);onSubPageChange(index)}function changeSubpage(index){index=parseInt(index);if(!subPageIndexValid(index))return;main.removeClass("subpage-transition");setTimeout(()=>{main.css("transform",parseInt(index)===0?"none":"translateX(-50%)");setTimeout(()=>{main.addClass("subpage-transition")},10)},10);changeNavButtons(index);onSubPageChange(index)}function subPageIndexValid(index){const valid=index!==currentSubPage&&index>=0&&index<subpageCount;if(valid)currentSubPage=index;return valid}function changeNavButtons(index){navButtons[index].css("opacity","0");setTimeout(()=>navButtons[index].css("visibility","hidden"),200);navButtons[(index+1)%2].css("opacity",".5");navButtons[(index+1)%2].css("visibility","visible")}function update(){if(currentScrollPos<lastScrollPos&&nav.hasClass(unpinned)){nav.removeClass(unpinned);nav.addClass(pinned)}else if(currentScrollPos>lastScrollPos&&(nav.hasClass(pinned)||!nav.hasClass(unpinned))){nav.removeClass(pinned);nav.addClass(unpinned)}lastScrollPos=currentScrollPos;updateRequested=false}